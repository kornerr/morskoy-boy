<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Подсчёт количества кораблей для игры "Морской бой"</title>
    </head>
    <body>
        <!-- Интерфейс -->
        <div>
            Поле:
            <pre id="поле"></pre>
        </div>
        <div>
            Количество кораблей разных длин:
            <pre id="результат"></pre>
        </div>
        <p>Внимание: код внутри страницы HTML на русском ;)</p>

        <!-- Логика -->
        <script>

function позициюВИндекс(ряд, столбец)
{
    return Number(ряд * 1000) + Number(столбец);
}

function индексВПозицию(индекс)
{
    var ряд = Math.round(индекс / 1000);
    var столбец = индекс - ряд * 1000;
    return [ряд, столбец];
}

function Корабли(строковоеПоле)
{
    this.проиндексировать = function(строковоеПоле)
    {
        var поле = строковоеПоле.trim();
        var строки = поле.split(/\n/);
        for (var ряд in строки)
        {
            var строка = строки[ряд];
            var элементы = строка.split(" ");
            for (var столбец in элементы)
            {
                var элемент = элементы[столбец];
                if (элемент == "1")
                {
                    var индекс = позициюВИндекс(ряд, столбец);
                    this.индексы[индекс] = true;
                }
            }
        }
    };
    this.индексДоступен = function(индекс)
    {
        if (индекс in this.индексы)
        {
            return this.индексы[индекс];
        }

        return false;
    };
    this.длинаВСтороне = function(начало, шаг)
    {
        var длина = 0;
        // 5 - максимальная длина корабля.
        for (var номер = 1; номер < 5; ++номер)
        {
            var ряд = начало[0] + шаг[0] * номер;
            var столбец = начало[1] + шаг[1] * номер;
            var индекс = позициюВИндекс(ряд, столбец);
            if (this.индексДоступен(индекс))
            {
                ++длина;
                this.индексы[индекс] = false;
            }
            else
            {
                break;
            }
        }
        return длина;
    };
    this.длинаКорабля = function(индекс)
    {
        var начало = индексВПозицию(индекс);

        var справа = this.длинаВСтороне(начало, [0, 1]);
        var слева = this.длинаВСтороне(начало, [0, -1]);
        var длина = 1 + справа + слева;

        var снизу = this.длинаВСтороне(начало, [1, 0]);
        var сверху = this.длинаВСтороне(начало, [-1, 0]);
        var длинаВертикально = 1 + снизу + сверху;

        if (длинаВертикально > длина)
        {
            длина = длинаВертикально;
        }

        // Помечаем текущий индекс как обработанный.
        this.индексы[индекс] = false;

        return длина;
    };
    this.количество = function()
    {
        var колво = {};

        for (var индекс in this.индексы)
        {
            if (this.индексДоступен(индекс))
            {
                var длина = this.длинаКорабля(индекс);
                if (!(длина in колво))
                {
                    колво[длина] = 0;
                }
                колво[длина] += 1;
            }
        }

        return колво;
    };

    // Конструктор.
    this.индексы = {};
    this.проиндексировать(строковоеПоле);
}

// Основной блок кода.

var поле =
    `
1 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 1 0 0 1 1 0 0 0 0
0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 1 0 0 1 0
1 0 0 0 0 1 0 0 0 0
1 0 0 0 0 1 0 0 0 0
1 0 0 0 0 0 0 0 0 0
1 0 0 1 1 1 1 0 0 0
1 0 0 0 0 0 0 0 0 0
    `;

// Отображаем поле в интерфейсе.
document.getElementById("поле").innerHTML = поле;

var корабли = new Корабли(поле);
var колво = корабли.количество();
// Отображаем количество кораблей в интерфейсе.
var результат = "";
for (var длина in колво)
{
    результат += длина + ": " + колво[длина] + "\n";
}
document.getElementById("результат").innerHTML = результат;
        </script>
    </body>
</html>
